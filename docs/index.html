<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>NaijaImport.calc â€” Nigeria Landed Cost Calculator</title>
<script>
tailwind.config = {
  darkMode: 'media',
  theme: {
    extend: {
      fontFamily: {
        serif: ['DM Serif Display','Georgia','serif'],
        sans:  ['Outfit','system-ui','sans-serif'],
        mono:  ['JetBrains Mono','monospace'],
      },
      keyframes: {
        fadeUp:   { from:{opacity:'0',transform:'translateY(14px)'}, to:{opacity:'1',transform:'translateY(0)'} },
        fadeIn:   { from:{opacity:'0'}, to:{opacity:'1'} },
        shimmer:  { '0%':{opacity:'.4'},'50%':{opacity:'1'},'100%':{opacity:'.4'} },
        slideDown:{ from:{opacity:'0',transform:'translateY(-8px)'}, to:{opacity:'1',transform:'translateY(0)'} },
        countUp:  { from:{opacity:'.3'}, to:{opacity:'1'} },
      },
      animation: {
        fadeUp:    'fadeUp .4s ease forwards',
        fadeIn:    'fadeIn .3s ease forwards',
        shimmer:   'shimmer 1.6s ease infinite',
        slideDown: 'slideDown .3s ease forwards',
        countUp:   'countUp .25s ease',
      },
    }
  }
}
</script>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"/>
<style>
  /* â”€â”€ Scrollbar â”€â”€ */
  ::-webkit-scrollbar{width:4px;height:4px;}
  ::-webkit-scrollbar-track{background:transparent;}
  ::-webkit-scrollbar-thumb{background:#d4d4d8;border-radius:2px;}
  @media(prefers-color-scheme:dark){::-webkit-scrollbar-thumb{background:#3f3f46;}}

  /* â”€â”€ Backdrop blur â”€â”€ */
  .nav-blur{backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);}

  /* â”€â”€ Custom select arrow â”€â”€ */
  .custom-select{
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M1 1l4 4 4-4' stroke='%239ca3af' stroke-width='1.5' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    background-repeat:no-repeat;
    background-position:right 14px center;
    padding-right:38px;
  }

  /* â”€â”€ Range slider â”€â”€ */
  input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:3px;border-radius:2px;background:#e4e4e7;outline:none;cursor:pointer;}
  @media(prefers-color-scheme:dark){input[type=range]{background:#3f3f46;}}
  input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:#10b981;border:2.5px solid white;box-shadow:0 1px 5px rgba(0,0,0,.2);cursor:pointer;transition:transform .15s;}
  @media(prefers-color-scheme:dark){input[type=range]::-webkit-slider-thumb{border-color:#18181b;}}
  input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.2);}

  /* â”€â”€ Focus ring â”€â”€ */
  .field-input:focus{outline:none;border-color:#10b981 !important;box-shadow:0 0 0 3px rgba(16,185,129,.1);}

  /* â”€â”€ Number flash â”€â”€ */
  .flash{animation:countUp .25s ease;}

  /* â”€â”€ FX ticker scroll â”€â”€ */
  @keyframes tickerMove{from{transform:translateX(0)}to{transform:translateX(-50%)}}
  .ticker-inner{display:flex;animation:tickerMove 28s linear infinite;width:max-content;}
  .ticker-inner:hover{animation-play-state:paused;}

  /* â”€â”€ Progress bar animate â”€â”€ */
  .prog-bar-fill{transition:width .6s cubic-bezier(.4,0,.2,1);}

  /* â”€â”€ Card shine on hover â”€â”€ */
  .result-card{transition:box-shadow .2s,transform .2s;}
  .result-card:hover{box-shadow:0 8px 32px rgba(0,0,0,.07);transform:translateY(-1px);}
  @media(prefers-color-scheme:dark){.result-card:hover{box-shadow:0 8px 32px rgba(0,0,0,.4);}}
</style>
</head>

<body class="bg-zinc-50 dark:bg-zinc-950 text-zinc-900 dark:text-zinc-100 font-sans antialiased">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STICKY NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="sticky top-0 z-50 bg-white/90 dark:bg-zinc-950/90 nav-blur border-b border-zinc-200 dark:border-zinc-800">
  <div class="max-w-screen-xl mx-auto px-5 sm:px-8 h-14 flex items-center justify-between gap-4">
    <div class="flex items-center gap-2.5">
      <span class="font-serif text-lg tracking-tight leading-none">NaijaImport<em class="text-emerald-600 dark:text-emerald-400 not-italic">.calc</em></span>
      <span class="hidden sm:block h-4 w-px bg-zinc-200 dark:bg-zinc-700"></span>
      <span class="hidden sm:block text-[9px] font-mono tracking-[.18em] text-zinc-400 dark:text-zinc-600 uppercase">Nigeria Customs 2024</span>
    </div>
    <div class="flex items-center gap-2.5">
      <div id="api-badge" class="flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-amber-50 dark:bg-amber-950/50 border border-amber-200 dark:border-amber-800 animate-shimmer">
        <span class="w-1.5 h-1.5 rounded-full bg-amber-400 flex-shrink-0"></span>
        <span class="text-[9px] font-mono font-semibold tracking-wider text-amber-600 dark:text-amber-400 uppercase">Loading Rates</span>
      </div>
    </div>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FX TICKER STRIP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="bg-white dark:bg-zinc-900 border-b border-zinc-100 dark:border-zinc-800 overflow-hidden h-10 flex items-center">
  <div class="ticker-inner gap-0" id="fx-ticker">
    <div class="flex items-center gap-0" id="fx-pairs-a"></div>
    <div class="flex items-center gap-0" id="fx-pairs-b"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STAT BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="bg-zinc-900 dark:bg-black overflow-x-auto">
  <div class="max-w-screen-xl mx-auto px-5 sm:px-8 flex items-stretch divide-x divide-zinc-800">
    <div class="flex flex-col justify-center py-4 pr-8 flex-shrink-0">
      <div class="font-serif text-2xl text-white leading-none" id="stat-usd">â€”</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-600 uppercase mt-1">USD/NGN Live</div>
    </div>
    <div class="flex flex-col justify-center py-4 px-8 flex-shrink-0">
      <div class="font-serif text-2xl text-white leading-none">7.5%</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-600 uppercase mt-1">VAT Rate</div>
    </div>
    <div class="flex flex-col justify-center py-4 px-8 flex-shrink-0">
      <div class="font-serif text-2xl text-white leading-none">5â€“35%</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-600 uppercase mt-1">Import Duty Range</div>
    </div>
    <div class="flex flex-col justify-center py-4 px-8 flex-shrink-0">
      <div class="font-serif text-2xl text-white leading-none">1%</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-600 uppercase mt-1">CISS Inspection</div>
    </div>
    <div class="flex flex-col justify-center py-4 px-8 flex-shrink-0">
      <div class="font-serif text-2xl text-white leading-none">22 days</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-600 uppercase mt-1">Avg Port Clearance</div>
    </div>
    <div class="flex flex-col justify-center py-4 pl-8 flex-shrink-0">
      <div class="font-serif text-2xl text-emerald-400 leading-none" id="stat-time">â€”</div>
      <div class="text-[9px] font-mono tracking-widest text-zinc-600 uppercase mt-1">Rates Updated</div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HERO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section class="max-w-screen-xl mx-auto px-5 sm:px-8 pt-12 pb-10">
  <p class="flex items-center gap-2.5 text-[10px] font-mono tracking-[.2em] text-emerald-600 dark:text-emerald-400 uppercase mb-4">
    <span class="inline-block w-7 h-px bg-emerald-500"></span>
    Nigeria Import Intelligence
  </p>
  <h1 class="font-serif text-5xl sm:text-6xl lg:text-7xl leading-[1.02] tracking-tight mb-5">
    Calculate Your <em class="text-emerald-600 dark:text-emerald-400">Real</em><br/>Landed Cost
  </h1>
  <p class="text-zinc-500 dark:text-zinc-400 text-[15px] max-w-lg leading-relaxed mb-7">
    The only Nigerian import calculator with <strong class="text-zinc-700 dark:text-zinc-300 font-semibold">live exchange rates</strong> â€” every charge included: customs duty, CISS, ETLS, port clearance, marine insurance, agent fees, and VAT. All computed from the 2024 Nigerian Customs Service tariff schedule.
  </p>
  <div class="flex flex-wrap gap-x-6 gap-y-2">
    <span class="flex items-center gap-1.5 text-xs text-zinc-500 dark:text-zinc-500"><span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>Live CBN FX Rates</span>
    <span class="flex items-center gap-1.5 text-xs text-zinc-500 dark:text-zinc-500"><span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>NCS 2024 Duty Schedule</span>
    <span class="flex items-center gap-1.5 text-xs text-zinc-500 dark:text-zinc-500"><span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>10 Source Countries</span>
    <span class="flex items-center gap-1.5 text-xs text-zinc-500 dark:text-zinc-500"><span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>FX Sensitivity Analysis</span>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN GRID
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="max-w-screen-xl mx-auto px-5 sm:px-8 pb-16">
  <div class="grid grid-cols-1 lg:grid-cols-[440px_1fr] gap-6 items-start">

    <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         FORM CARD
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="sticky top-16 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm">

      <!-- Form header -->
      <div class="bg-zinc-950 dark:bg-black px-6 py-5 border-b border-zinc-800">
        <h2 class="font-serif text-white text-xl leading-tight">Import Details</h2>
        <p class="text-zinc-500 text-[11px] font-mono mt-1 tracking-wider">Fill all fields Â· Rates are live</p>
      </div>

      <div class="p-6 space-y-5">

        <!-- Product Category -->
        <div>
          <label class="block text-[10px] font-mono font-semibold tracking-[.1em] uppercase text-zinc-500 dark:text-zinc-400 mb-2">Product Category <span class="text-red-400">*</span></label>
          <select id="category" onchange="onCategoryChange()" class="field-input custom-select w-full bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-3 text-sm font-medium text-zinc-800 dark:text-zinc-200 appearance-none cursor-pointer transition-colors focus:outline-none">
            <optgroup label="ğŸ“± Electronics & Technology">
              <option value="phones"      data-duty="20" data-levy="1"   data-vat="7.5">Mobile Phones & Smartphones</option>
              <option value="computers"   data-duty="10" data-levy="0"   data-vat="7.5">Computers, Laptops & Tablets</option>
              <option value="tv_audio"    data-duty="20" data-levy="1"   data-vat="7.5">TVs, Audio & Visual Equipment</option>
              <option value="elec_acc"    data-duty="20" data-levy="1"   data-vat="7.5">Electronics Accessories & Cables</option>
              <option value="solar"       data-duty="5"  data-levy="0"   data-vat="7.5">Solar & Renewable Energy Equipment</option>
            </optgroup>
            <optgroup label="ğŸ›’ FMCG & Food">
              <option value="proc_food"   data-duty="20" data-levy="1"   data-vat="0">Processed Foods & Packaged Beverages</option>
              <option value="rice_wheat"  data-duty="5"  data-levy="0"   data-vat="0">Rice, Wheat & Grains</option>
              <option value="sugar"       data-duty="20" data-levy="1"   data-vat="0">Sugar & Confectionery</option>
              <option value="household"   data-duty="20" data-levy="1"   data-vat="7.5">Household & Personal Care Products</option>
              <option value="cosmetics"   data-duty="20" data-levy="1"   data-vat="7.5">Cosmetics & Beauty Products</option>
            </optgroup>
            <optgroup label="ğŸ’Š Pharmaceuticals">
              <option value="medicines"   data-duty="0"  data-levy="0"   data-vat="0">Medicines & Pharmaceutical Drugs</option>
              <option value="med_equip"   data-duty="5"  data-levy="0"   data-vat="0">Medical Equipment & Devices</option>
            </optgroup>
            <optgroup label="ğŸš— Automotive & Spare Parts">
              <option value="spare_parts" data-duty="20" data-levy="1"   data-vat="7.5">Engine & Mechanical Spare Parts</option>
              <option value="vehicles"    data-duty="35" data-levy="2"   data-vat="7.5">Passenger Vehicles (Cars)</option>
              <option value="trucks"      data-duty="35" data-levy="2"   data-vat="7.5">Commercial Trucks & Buses</option>
              <option value="tyres"       data-duty="20" data-levy="1"   data-vat="7.5">Tyres & Rubber Products</option>
              <option value="lubricants"  data-duty="10" data-levy="0.5" data-vat="7.5">Lubricants & Engine Oil</option>
            </optgroup>
            <optgroup label="ğŸ­ Industrial & Manufacturing">
              <option value="machinery"   data-duty="5"  data-levy="0"   data-vat="7.5">Industrial Machinery & Equipment</option>
              <option value="generators"  data-duty="10" data-levy="0.5" data-vat="7.5">Generators & Power Equipment</option>
              <option value="steel"       data-duty="10" data-levy="0.5" data-vat="7.5">Steel, Iron & Metal Products</option>
              <option value="chemicals"   data-duty="5"  data-levy="0"   data-vat="7.5">Industrial Chemicals & Raw Inputs</option>
            </optgroup>
            <optgroup label="ğŸ—ï¸ Construction">
              <option value="tiles"       data-duty="10" data-levy="0.5" data-vat="7.5">Tiles, Ceramics & Sanitary Ware</option>
              <option value="electrical"  data-duty="10" data-levy="0.5" data-vat="7.5">Electrical Fittings & Wire</option>
              <option value="paint"       data-duty="20" data-levy="1"   data-vat="7.5">Paint & Finishing Materials</option>
            </optgroup>
            <optgroup label="ğŸ‘— Textiles & Fashion">
              <option value="fabric"      data-duty="20" data-levy="1"   data-vat="7.5">Fabrics & Textiles</option>
              <option value="clothing"    data-duty="35" data-levy="2"   data-vat="7.5">Clothing & Apparel</option>
              <option value="footwear"    data-duty="35" data-levy="2"   data-vat="7.5">Footwear & Shoes</option>
            </optgroup>
            <optgroup label="ğŸŒ¾ Agriculture">
              <option value="fertilizer"  data-duty="0"  data-levy="0"   data-vat="0">Fertilizers & Agro-Chemicals</option>
              <option value="agri"        data-duty="5"  data-levy="0"   data-vat="0">Agricultural Produce</option>
            </optgroup>
          </select>
          <div id="duty-hint" class="mt-2 text-[10px] font-mono text-zinc-400 dark:text-zinc-600">Import Duty: 20% Â· ECOWAS Levy: 1% Â· VAT: 7.5%</div>
        </div>

        <!-- Product name -->
        <div>
          <label class="block text-[10px] font-mono font-semibold tracking-[.1em] uppercase text-zinc-500 dark:text-zinc-400 mb-2">Product Name</label>
          <input type="text" id="product-name" placeholder="e.g. Samsung Galaxy A55, Indomie Ã—500, Engine Oil 5L"
            class="field-input w-full bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-3 text-sm text-zinc-800 dark:text-zinc-200 placeholder-zinc-400 transition-colors"/>
        </div>

        <!-- Divider -->
        <div class="flex items-center gap-3">
          <div class="flex-1 h-px bg-zinc-100 dark:bg-zinc-800"></div>
          <span class="text-[9px] font-mono tracking-[.16em] text-zinc-400 dark:text-zinc-600 uppercase">Origin & Pricing</span>
          <div class="flex-1 h-px bg-zinc-100 dark:bg-zinc-800"></div>
        </div>

        <!-- Source Country -->
        <div>
          <label class="block text-[10px] font-mono font-semibold tracking-[.1em] uppercase text-zinc-500 dark:text-zinc-400 mb-2">Source Country <span class="text-red-400">*</span></label>
          <select id="country" onchange="onCountryChange()" class="field-input custom-select w-full bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-3 text-sm font-medium text-zinc-800 dark:text-zinc-200 appearance-none cursor-pointer transition-colors focus:outline-none">
            <option value="CNY"     data-ship="185000" data-transit="45" data-port="Apapa / Tin Can">ğŸ‡¨ğŸ‡³ China (Guangzhou, Shenzhen, Yiwu)</option>
            <option value="USD"     data-ship="320000" data-transit="21" data-port="Apapa / Onne">ğŸ‡ºğŸ‡¸ United States of America</option>
            <option value="GBP"     data-ship="290000" data-transit="18" data-port="Apapa">ğŸ‡¬ğŸ‡§ United Kingdom</option>
            <option value="EUR"     data-ship="265000" data-transit="16" data-port="Apapa">ğŸ‡©ğŸ‡ª Germany / Europe (EU)</option>
            <option value="INR"     data-ship="145000" data-transit="22" data-port="Onne / Apapa">ğŸ‡®ğŸ‡³ India (Mumbai, Surat, Delhi)</option>
            <option value="AED"     data-ship="92000"  data-transit="10" data-port="Apapa / Tin Can">ğŸ‡¦ğŸ‡ª UAE / Dubai (Jebel Ali)</option>
            <option value="USD_KR"  data-ship="215000" data-transit="35" data-port="Apapa">ğŸ‡°ğŸ‡· South Korea</option>
            <option value="USD_JP"  data-ship="235000" data-transit="38" data-port="Apapa">ğŸ‡¯ğŸ‡µ Japan</option>
            <option value="USD_SA"  data-ship="62000"  data-transit="6"  data-port="Onne / Calabar">ğŸ‡¿ğŸ‡¦ South Africa</option>
            <option value="TRY"     data-ship="175000" data-transit="14" data-port="Apapa">ğŸ‡¹ğŸ‡· Turkey (Istanbul, Izmir)</option>
          </select>
          <div id="country-hint" class="mt-2 text-[10px] font-mono text-zinc-400 dark:text-zinc-600">Transit: 45 days Â· Port: Apapa / Tin Can Â· Est. freight: â‚¦185,000</div>
        </div>

        <!-- Unit cost + Qty -->
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-[10px] font-mono font-semibold tracking-[.1em] uppercase text-zinc-500 dark:text-zinc-400 mb-2">Unit Cost (USD $) <span class="text-red-400">*</span></label>
            <input type="number" id="unit-cost" placeholder="250.00" min="0" step="0.01" oninput="autoEstimate()"
              class="field-input w-full bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-3 text-sm font-medium text-zinc-800 dark:text-zinc-200 placeholder-zinc-400 transition-colors"/>
            <p class="mt-1.5 text-[10px] font-mono text-zinc-400">FOB / CIF per unit</p>
          </div>
          <div>
            <label class="block text-[10px] font-mono font-semibold tracking-[.1em] uppercase text-zinc-500 dark:text-zinc-400 mb-2">Quantity (Units) <span class="text-red-400">*</span></label>
            <input type="number" id="qty" placeholder="100" min="1" step="1" oninput="autoEstimate()"
              class="field-input w-full bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-3 text-sm font-medium text-zinc-800 dark:text-zinc-200 placeholder-zinc-400 transition-colors"/>
          </div>
        </div>

        <!-- Quick estimate pill -->
        <div id="auto-est" class="hidden px-4 py-3 bg-emerald-50 dark:bg-emerald-950/40 border border-emerald-200 dark:border-emerald-800 rounded-xl text-[11px] font-mono text-emerald-700 dark:text-emerald-400 animate-slideDown"></div>

        <!-- Divider -->
        <div class="flex items-center gap-3">
          <div class="flex-1 h-px bg-zinc-100 dark:bg-zinc-800"></div>
          <span class="text-[9px] font-mono tracking-[.16em] text-zinc-400 dark:text-zinc-600 uppercase">Shipping & Port</span>
          <div class="flex-1 h-px bg-zinc-100 dark:bg-zinc-800"></div>
        </div>

        <!-- Freight -->
        <div>
          <label class="block text-[10px] font-mono font-semibold tracking-[.1em] uppercase text-zinc-500 dark:text-zinc-400 mb-2">Freight / Shipping (â‚¦) <span class="text-zinc-300 dark:text-zinc-700 font-normal">â€” Optional</span></label>
          <input type="number" id="freight" placeholder="Leave blank to auto-estimate"
            class="field-input w-full bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-3 text-sm text-zinc-800 dark:text-zinc-200 placeholder-zinc-400 transition-colors"/>
          <div id="freight-hint" class="mt-1.5 text-[10px] font-mono text-zinc-400 dark:text-zinc-600">Auto-estimate: â‚¦185,000 for China sea freight</div>
        </div>

        <!-- Port -->
        <div>
          <label class="block text-[10px] font-mono font-semibold tracking-[.1em] uppercase text-zinc-500 dark:text-zinc-400 mb-2">Port of Entry</label>
          <select id="port" onchange="onPortChange()" class="field-input custom-select w-full bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-xl px-4 py-3 text-sm font-medium text-zinc-800 dark:text-zinc-200 appearance-none cursor-pointer transition-colors focus:outline-none">
            <option value="apapa"  data-clear="88000" data-days="22">Apapa Port, Lagos (Busiest)</option>
            <option value="tincan" data-clear="82000" data-days="18">Tin Can Island Port, Lagos</option>
            <option value="onne"   data-clear="74000" data-days="14">Onne Port, Rivers State (Port Harcourt)</option>
            <option value="calabar"data-clear="68000" data-days="12">Calabar Port, Cross River State</option>
            <option value="warri"  data-clear="65000" data-days="14">Warri Port, Delta State</option>
            <option value="kano"   data-clear="55000" data-days="10">Kano Inland Dry Port</option>
          </select>
          <div id="port-hint" class="mt-1.5 text-[10px] font-mono text-zinc-400 dark:text-zinc-600">Avg clearance: 22 days Â· Agent fee: ~â‚¦88,000</div>
        </div>

        <!-- Calculate Button -->
        <button id="calc-btn" onclick="calculate()" disabled
          class="w-full mt-1 bg-zinc-900 dark:bg-white hover:bg-zinc-800 dark:hover:bg-zinc-100 disabled:opacity-50 disabled:cursor-not-allowed text-white dark:text-zinc-900 font-bold text-sm py-4 rounded-xl transition-all duration-200 flex items-center justify-center gap-2.5 shadow-sm hover:shadow-md hover:-translate-y-0.5">
          <span id="btn-text">âŸ³ Loading live ratesâ€¦</span>
          <span class="transition-transform group-hover:translate-x-1">â†’</span>
        </button>

      </div>
    </div>

    <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         RESULTS PANEL
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="space-y-5">

      <!-- Empty state -->
      <div id="empty-state" class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-16 text-center shadow-sm">
        <div class="text-5xl mb-4 opacity-20">âš¡</div>
        <h3 class="font-semibold text-zinc-700 dark:text-zinc-300 mb-2">Ready to Calculate</h3>
        <p class="text-sm text-zinc-400 dark:text-zinc-600 max-w-xs mx-auto">Fill in your product details and click Calculate to see your full landed cost with live exchange rates.</p>
      </div>

      <!-- â”€â”€ TOTAL CARD â”€â”€ -->
      <div id="res-total-card" class="hidden bg-zinc-950 dark:bg-black rounded-2xl overflow-hidden shadow-md animate-fadeUp">
        <div class="p-7 relative overflow-hidden">
          <!-- Decorative blobs -->
          <div class="absolute -top-10 -right-10 w-40 h-40 rounded-full bg-emerald-500/[.06] pointer-events-none"></div>
          <div class="absolute -bottom-8 -left-6 w-32 h-32 rounded-full bg-amber-400/[.04] pointer-events-none"></div>
          <div class="relative">
            <p class="text-[9px] font-mono tracking-[.2em] text-zinc-600 uppercase mb-2" id="res-company-label">â€”</p>
            <p class="text-[11px] font-mono text-zinc-500 mb-2">Total Landed Cost â€” Nigeria (Live Rate)</p>
            <div id="res-amount" class="font-serif text-5xl sm:text-6xl text-white leading-none mb-2">â‚¦0</div>
            <p class="text-xs font-mono text-zinc-500" id="res-usd-line">â€”</p>
            <p class="text-xs font-mono text-zinc-600 mt-1" id="res-per-line">â€”</p>
          </div>
          <!-- Mini KPIs -->
          <div class="grid grid-cols-3 gap-0 mt-6 pt-5 border-t border-zinc-800">
            <div class="text-center px-3 border-r border-zinc-800">
              <div id="res-markup" class="font-mono text-base font-semibold text-white">0%</div>
              <div class="text-[9px] font-mono text-zinc-600 mt-1 tracking-wider uppercase">Total Markup</div>
            </div>
            <div class="text-center px-3 border-r border-zinc-800">
              <div id="res-duties" class="font-mono text-base font-semibold text-amber-400">â‚¦0</div>
              <div class="text-[9px] font-mono text-zinc-600 mt-1 tracking-wider uppercase">All Duties + VAT</div>
            </div>
            <div class="text-center px-3">
              <div id="res-min-sell" class="font-mono text-base font-semibold text-emerald-400">â‚¦0</div>
              <div class="text-[9px] font-mono text-zinc-600 mt-1 tracking-wider uppercase">Min. Sell (+20%)</div>
            </div>
          </div>
        </div>
        <!-- Live rate ribbon -->
        <div class="bg-zinc-900 px-7 py-3 flex items-center justify-between">
          <span class="text-[10px] font-mono text-zinc-600" id="res-rate-ribbon">â€”</span>
          <span class="flex items-center gap-1.5 text-[10px] font-mono text-emerald-500">
            <span class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></span>Live rate applied
          </span>
        </div>
      </div>

      <!-- â”€â”€ BREAKDOWN CARD â”€â”€ -->
      <div id="res-breakdown" class="hidden bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm result-card animate-fadeUp">
        <div class="px-6 py-4 bg-zinc-50 dark:bg-zinc-900 border-b border-zinc-100 dark:border-zinc-800 flex items-center justify-between">
          <span class="text-[10px] font-mono font-semibold tracking-widest text-zinc-500 uppercase">Full Cost Breakdown</span>
          <span id="breakdown-label" class="text-[10px] font-mono text-zinc-400">â€”</span>
        </div>
        <div id="breakdown-body" class="divide-y divide-zinc-50 dark:divide-zinc-800/50"></div>
        <div id="duty-note-area" class="px-5 pb-5 space-y-2"></div>
      </div>

      <!-- â”€â”€ CHARTS â”€â”€ -->
      <div id="res-charts" class="hidden grid grid-cols-1 sm:grid-cols-2 gap-5 animate-fadeUp">
        <div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-5 shadow-sm result-card">
          <p class="text-[9px] font-mono tracking-widest text-zinc-400 uppercase mb-1">Cost Structure</p>
          <p class="text-sm font-semibold text-zinc-800 dark:text-zinc-200 mb-4">What makes up your total cost</p>
          <div class="h-48 relative"><canvas id="pieChart"></canvas></div>
        </div>
        <div class="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-5 shadow-sm result-card">
          <p class="text-[9px] font-mono tracking-widest text-zinc-400 uppercase mb-1">FX Sensitivity</p>
          <p class="text-sm font-semibold text-zinc-800 dark:text-zinc-200 mb-4">How Naira weakness affects your cost</p>
          <div class="h-48 relative"><canvas id="fxChart"></canvas></div>
        </div>
      </div>

    </div><!-- /results -->
  </div><!-- /grid -->

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PRO TIPS
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="mt-10 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm">
    <div class="bg-zinc-950 dark:bg-black px-7 py-5">
      <h2 class="font-serif text-white text-xl">Expert Cost-Saving Strategies</h2>
      <p class="text-zinc-500 text-[11px] font-mono mt-1">From a Procurement Manager â€” real advice for Nigerian importers</p>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 divide-y sm:divide-y-0 sm:divide-x divide-zinc-100 dark:divide-zinc-800">
      <div class="p-6 hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors">
        <div class="text-2xl mb-3">ğŸ’±</div>
        <h3 class="font-semibold text-sm text-zinc-800 dark:text-zinc-200 mb-2">Hedge Your FX Exposure Early</h3>
        <p class="text-xs text-zinc-500 dark:text-zinc-500 leading-relaxed">USD/NGN moved from â‚¦416 â†’ â‚¦1,590 in two years. Open a domiciliary account and buy USD when rates are favorable. On a $50,000 PO, a â‚¦200 rate swing equals â‚¦10M in extra cost.</p>
      </div>
      <div class="p-6 hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors">
        <div class="text-2xl mb-3">ğŸ‡¦ğŸ‡ª</div>
        <h3 class="font-semibold text-sm text-zinc-800 dark:text-zinc-200 mb-2">Source via Dubai to Cut Lead Time</h3>
        <p class="text-xs text-zinc-500 dark:text-zinc-500 leading-relaxed">UAE transit averages 10 days vs 45 from China. Faster clearance = lower demurrage at Apapa. The Dubai premium often costs less than 2 weeks of port storage fees.</p>
      </div>
      <div class="p-6 hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors">
        <div class="text-2xl mb-3">âš“</div>
        <h3 class="font-semibold text-sm text-zinc-800 dark:text-zinc-200 mb-2">Use Onne or Calabar â€” Not Always Apapa</h3>
        <p class="text-xs text-zinc-500 dark:text-zinc-500 leading-relaxed">Apapa congestion adds 3â€“14 extra days. Onne Port (Rivers State) processes 30â€“40% faster, and clearing fees are 15â€“20% lower. Better for South-South cargo.</p>
      </div>
      <div class="p-6 hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors sm:border-t dark:sm:border-zinc-800">
        <div class="text-2xl mb-3">ğŸ“‹</div>
        <h3 class="font-semibold text-sm text-zinc-800 dark:text-zinc-200 mb-2">Classify Your HS Code Correctly First Time</h3>
        <p class="text-xs text-zinc-500 dark:text-zinc-500 leading-relaxed">Wrong HS Code is Nigeria's #1 customs dispute trigger. Electronics misclassified as accessories = wrong duty rate. Engage a licensed customs broker before the goods ship.</p>
      </div>
      <div class="p-6 hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors sm:border-t dark:sm:border-zinc-800">
        <div class="text-2xl mb-3">ğŸ­</div>
        <h3 class="font-semibold text-sm text-zinc-800 dark:text-zinc-200 mb-2">ETLS Certification = 0% Duty from ECOWAS</h3>
        <p class="text-xs text-zinc-500 dark:text-zinc-500 leading-relaxed">If your ECOWAS supplier (Ghana, Benin, CÃ´te d'Ivoire) has ETLS certification, qualifying goods attract 0% import duty. Can save 5â€“20% on every shipment permanently.</p>
      </div>
      <div class="p-6 hover:bg-zinc-50 dark:hover:bg-zinc-800/40 transition-colors sm:border-t dark:sm:border-zinc-800">
        <div class="text-2xl mb-3">ğŸ“¦</div>
        <h3 class="font-semibold text-sm text-zinc-800 dark:text-zinc-200 mb-2">Consolidate Shipments to Reduce Fixed Costs</h3>
        <p class="text-xs text-zinc-500 dark:text-zinc-500 leading-relaxed">Terminal handling and CISS inspection have fixed base components. Shipping 500 units instead of 100 spreads these costs and cuts per-unit landed cost by 8â€“15%.</p>
      </div>
    </div>
  </div>

</main>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<footer class="border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-zinc-950">
  <div class="max-w-screen-xl mx-auto px-5 sm:px-8 py-7 flex flex-wrap justify-between items-center gap-4">
    <p class="text-[11px] font-mono text-zinc-400"><strong class="text-zinc-600 dark:text-zinc-300">Miracle Ugokwe</strong> Â· Procurement Manager & Data Analyst Â· MSc Procurement Management, FUTO</p>
    <p class="text-[10px] font-mono text-zinc-300 dark:text-zinc-700">FX: ExchangeRate-API (live) Â· Duties: NCS Tariff 2024 Â· Port Charges: NPA Schedule</p>
  </div>
</footer>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
const API_KEY = 'c31305d8c28ceaa6689c4d07';
const API_URL = `https://v6.exchangerate-api.com/v6/${API_KEY}/latest/USD`;

let NGN = {}; // NGN per 1 unit of each currency
let NGN_USD = 1590; // fallback
let ratesLoaded = false;
let lastUpdated = '';
let pieInst = null, fxInst = null;

const isDark = () => window.matchMedia('(prefers-color-scheme:dark)').matches;

// â”€â”€ LIVE FX â”€â”€
async function loadRates() {
  try {
    const res  = await fetch(API_URL);
    const data = await res.json();
    if (data.result !== 'success') throw new Error(data['error-type']);

    const fx   = data.conversion_rates;
    NGN_USD    = fx.NGN;
    NGN = {
      USD: fx.NGN,
      CNY: fx.NGN / fx.CNY,
      EUR: fx.NGN / fx.EUR,
      GBP: fx.NGN / fx.GBP,
      INR: fx.NGN / fx.INR,
      AED: fx.NGN / fx.AED,
      TRY: fx.NGN / fx.TRY,
    };

    const now  = new Date();
    lastUpdated = now.toLocaleTimeString('en-NG',{hour:'2-digit',minute:'2-digit'});

    renderTicker();
    document.getElementById('stat-usd').textContent  = 'â‚¦'+Math.round(NGN_USD).toLocaleString();
    document.getElementById('stat-time').textContent = lastUpdated;

    setBadge('live');
    ratesLoaded = true;
    document.getElementById('calc-btn').disabled = false;
    document.getElementById('btn-text').textContent = 'Calculate Landed Cost';

  } catch(e) {
    // Fallback
    NGN = { USD:1590, CNY:219, EUR:1724, GBP:2012, INR:19.1, AED:433, TRY:49 };
    NGN_USD = 1590;
    renderTicker();
    document.getElementById('stat-usd').textContent  = 'â‚¦1,590';
    document.getElementById('stat-time').textContent = 'Fallback';
    setBadge('fallback');
    ratesLoaded = true;
    document.getElementById('calc-btn').disabled = false;
    document.getElementById('btn-text').textContent = 'Calculate Landed Cost';
  }
}

function setBadge(state) {
  const b = document.getElementById('api-badge');
  if (state === 'live') {
    b.className = 'flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-emerald-50 dark:bg-emerald-950/50 border border-emerald-200 dark:border-emerald-800';
    b.innerHTML = '<span class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse flex-shrink-0"></span><span class="text-[9px] font-mono font-semibold tracking-wider text-emerald-600 dark:text-emerald-400 uppercase">Live Â· '+lastUpdated+'</span>';
  } else {
    b.className = 'flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-amber-50 dark:bg-amber-950/50 border border-amber-200 dark:border-amber-800';
    b.innerHTML = '<span class="w-1.5 h-1.5 rounded-full bg-amber-400 flex-shrink-0"></span><span class="text-[9px] font-mono font-semibold tracking-wider text-amber-600 dark:text-amber-400 uppercase">Fallback Rates</span>';
  }
}

function renderTicker() {
  const pairs = [
    {label:'USD/NGN', val: Math.round(NGN.USD).toLocaleString()},
    {label:'EUR/NGN', val: Math.round(NGN.EUR).toLocaleString()},
    {label:'GBP/NGN', val: Math.round(NGN.GBP).toLocaleString()},
    {label:'CNY/NGN', val: NGN.CNY.toFixed(1)},
    {label:'AED/NGN', val: Math.round(NGN.AED).toLocaleString()},
    {label:'INR/NGN', val: NGN.INR.toFixed(2)},
    {label:'TRY/NGN', val: Math.round(NGN.TRY).toLocaleString()},
  ];
  const html = pairs.map(p =>
    `<div class="flex items-center gap-3 px-5 border-r border-zinc-100 dark:border-zinc-800 h-10 flex-shrink-0">
       <span class="text-[10px] font-mono text-zinc-400 dark:text-zinc-600 tracking-wider">${p.label}</span>
       <span class="text-[12px] font-mono font-semibold text-zinc-700 dark:text-zinc-300">${p.val}</span>
     </div>`).join('');
  document.getElementById('fx-pairs-a').innerHTML = html;
  document.getElementById('fx-pairs-b').innerHTML = html;
}

// â”€â”€ FORMAT â”€â”€
function fmt(n)  { return 'â‚¦'+Math.round(n).toLocaleString(); }
function fmtU(n) { return '$'+(n/NGN_USD).toLocaleString('en',{minimumFractionDigits:0,maximumFractionDigits:0}); }

function getCurr(countryVal) {
  return countryVal.startsWith('USD') ? 'USD' : countryVal;
}

// â”€â”€ FIELD EVENTS â”€â”€
function onCategoryChange() {
  const o = document.getElementById('category').selectedOptions[0];
  const vatStr = o.dataset.vat === '0' ? 'EXEMPT' : '7.5%';
  document.getElementById('duty-hint').textContent = `Import Duty: ${o.dataset.duty}% Â· ECOWAS Levy: ${o.dataset.levy}% Â· VAT: ${vatStr}`;
  autoEstimate();
}

function onCountryChange() {
  const o   = document.getElementById('country').selectedOptions[0];
  const curr = getCurr(o.value);
  const rate = NGN[curr] || NGN.USD;
  document.getElementById('country-hint').textContent   = `Transit: ${o.dataset.transit} days Â· Port: ${o.dataset.port} Â· Est. freight: â‚¦${parseInt(o.dataset.ship).toLocaleString()} Â· â‚¦${Math.round(rate).toLocaleString()}/${curr}`;
  document.getElementById('freight-hint').textContent   = `Auto-estimate: â‚¦${parseInt(o.dataset.ship).toLocaleString()} based on ${o.text.split('(')[0].trim()} sea freight`;
  autoEstimate();
}

function onPortChange() {
  const o = document.getElementById('port').selectedOptions[0];
  document.getElementById('port-hint').textContent = `Avg clearance: ${o.dataset.days} days Â· Agent fee: ~â‚¦${parseInt(o.dataset.clear).toLocaleString()}`;
}

function autoEstimate() {
  if (!ratesLoaded) return;
  const usd = parseFloat(document.getElementById('unit-cost').value) || 0;
  const qty = parseInt(document.getElementById('qty').value)         || 0;
  const el  = document.getElementById('auto-est');
  if (usd > 0 && qty > 0) {
    const rough = usd * qty * NGN_USD * 1.55;
    el.textContent = `Quick estimate: ~${fmt(rough)} total (Â±15%) Â· Click Calculate for exact breakdown`;
    el.classList.remove('hidden');
  } else {
    el.classList.add('hidden');
  }
}

// â”€â”€ CALCULATE â”€â”€
function calculate() {
  const catOpt   = document.getElementById('category').selectedOptions[0];
  const cntOpt   = document.getElementById('country').selectedOptions[0];
  const portOpt  = document.getElementById('port').selectedOptions[0];

  const dutyR    = parseFloat(catOpt.dataset.duty)  / 100;
  const levyR    = parseFloat(catOpt.dataset.levy)  / 100;
  const vatR     = parseFloat(catOpt.dataset.vat)   / 100;
  const estFreight = parseInt(cntOpt.dataset.ship);
  const clearBase  = parseInt(portOpt.dataset.clear);

  const curr     = getCurr(cntOpt.value);
  const liveRate = NGN[curr] || NGN.USD;

  const unitUSD  = parseFloat(document.getElementById('unit-cost').value) || 0;
  const qty      = parseInt(document.getElementById('qty').value)         || 1;
  const fRaw     = document.getElementById('freight').value;
  const freight  = fRaw ? parseFloat(fRaw) : estFreight;

  if (unitUSD <= 0) {
    document.getElementById('unit-cost').focus();
    document.getElementById('unit-cost').classList.add('border-red-400');
    setTimeout(()=>document.getElementById('unit-cost').classList.remove('border-red-400'),2000);
    return;
  }

  // â”€â”€ CORE MATHS â”€â”€
  const fobTotal    = unitUSD * liveRate * qty;
  const freightT    = freight;
  const insurance   = fobTotal * 0.005;
  const cif         = fobTotal + freightT + insurance;

  const importDuty  = cif * dutyR;
  const ecowasLevy  = cif * levyR;
  const ciss        = cif * 0.01;
  const etls        = cif * 0.005;
  const surcharge   = importDuty * 0.07;
  const allDuties   = importDuty + ecowasLevy + ciss + etls + surcharge;

  const vat         = (cif + allDuties) * vatR;
  const thc         = cif * 0.02;
  const clearing    = clearBase * (Math.ceil(qty / 100) + 1);
  const portTotal   = thc + clearing;

  const grandTotal  = cif + allDuties + vat + portTotal;
  const perUnit     = grandTotal / qty;
  const markup      = ((grandTotal / fobTotal) - 1) * 100;
  const minSell     = grandTotal * 1.2;

  const pname = document.getElementById('product-name').value || catOpt.text;

  // â”€â”€ SHOW RESULTS â”€â”€
  document.getElementById('empty-state').classList.add('hidden');
  ['res-total-card','res-breakdown','res-charts'].forEach(id => {
    const el = document.getElementById(id);
    el.classList.remove('hidden');
    el.classList.add('animate-fadeUp');
  });
  document.getElementById('res-charts').classList.remove('grid');
  document.getElementById('res-charts').classList.add('grid');

  // Total card
  setFlash('res-amount',   fmt(grandTotal));
  setFlash('res-markup',   markup.toFixed(1)+'%');
  setFlash('res-duties',   fmt(allDuties+vat));
  setFlash('res-min-sell', fmt(minSell/qty)+'/unit');
  document.getElementById('res-company-label').textContent = pname+' Â· '+qty+' units';
  document.getElementById('res-usd-line').textContent      = fmtU(grandTotal)+` USD  Â·  live rate â‚¦${Math.round(liveRate).toLocaleString()}/${curr}`;
  document.getElementById('res-per-line').textContent      = fmt(perUnit)+' per unit  Â·  '+fmtU(perUnit)+'/unit';
  document.getElementById('res-rate-ribbon').textContent   = `Rates fetched ${lastUpdated} Â· â‚¦${Math.round(liveRate).toLocaleString()}/${curr} applied`;

  // â”€â”€ BREAKDOWN ROWS â”€â”€
  document.getElementById('breakdown-label').textContent = pname+' Â· '+qty+' units';

  const rows = [
    {group:'Product & Shipping'},
    {name:'Product Cost (FOB)', val:fobTotal, color:'#1d4ed8', note:`${qty} Ã— $${unitUSD.toFixed(2)} Ã— â‚¦${Math.round(liveRate).toLocaleString()} (live ${curr}/NGN)`},
    {name:'Freight & Shipping',  val:freightT, color:'#2563eb', note:cntOpt.text.split('(')[0].trim()+' â†’ Nigeria (sea freight)'},
    {name:'Marine Insurance (0.5%)', val:insurance, color:'#3b82f6', note:'Standard cargo insurance on CIF value'},
    {divider:true},
    {group:'Customs Duties & Government Levies'},
    {name:`Import Duty (${Math.round(dutyR*100)}%)`,         val:importDuty, color:'#b45309', note:'Nigerian Customs Service Tariff 2024'},
    {name:`ECOWAS Trade Levy (${(levyR*100).toFixed(1)}%)`,  val:ecowasLevy, color:'#d97706', note:'ECOWAS Trade Liberalization Scheme'},
    {name:'CISS Inspection Fee (1%)',                         val:ciss,       color:'#f59e0b', note:'Comprehensive Import Supervision Scheme'},
    {name:'ETLS Levy (0.5%)',                                 val:etls,       color:'#fbbf24', note:'Economic Community Levy'},
    {name:'Surcharge on Import Duty (7%)',                    val:surcharge,  color:'#92400e', note:'Applied on import duty value'},
    {divider:true},
    {group:'Tax'},
    {name:vatR>0?'VAT (7.5% on CIF + Duties)':'VAT â€” EXEMPT for this category', val:vat, color:'#059669', note:vatR>0?'Federal Inland Revenue Service':'Category exempt under FIRS Schedule'},
    {divider:true},
    {group:'Port & Clearing'},
    {name:'Terminal Handling Charge (2%)',  val:thc,      color:'#0f766e', note:portOpt.text},
    {name:'Customs Clearing Agent Fee',     val:clearing, color:'#374151', note:'Licensed NCS clearing agent Â· scales with quantity'},
    {divider:true},
    {total:true, name:'TOTAL LANDED COST', val:grandTotal},
  ];

  const bd = document.getElementById('breakdown-body');
  bd.innerHTML = '';
  rows.forEach(r => {
    if (r.group) {
      bd.innerHTML += `<div class="px-5 py-2 bg-zinc-50 dark:bg-zinc-800/60 border-y border-zinc-100 dark:border-zinc-800">
        <span class="text-[9px] font-mono font-semibold tracking-[.14em] text-zinc-400 dark:text-zinc-600 uppercase">${r.group}</span>
      </div>`;
      return;
    }
    if (r.divider) { bd.innerHTML += `<div class="h-px bg-zinc-50 dark:bg-zinc-800/40"></div>`; return; }
    if (r.total) {
      bd.innerHTML += `<div class="flex justify-between items-center px-5 py-4 bg-emerald-50 dark:bg-emerald-950/30 border-t-2 border-emerald-200 dark:border-emerald-800">
        <div class="flex items-center gap-2.5"><div class="w-2 h-2 rounded-sm bg-emerald-600"></div><span class="font-bold text-sm text-emerald-800 dark:text-emerald-300">${r.name}</span></div>
        <div class="text-right"><div class="font-mono text-base font-bold text-emerald-700 dark:text-emerald-400">${fmt(r.val)}</div><div class="text-[9px] font-mono text-zinc-400 mt-0.5">100%</div></div>
      </div>`;
      return;
    }
    const pct  = ((r.val/grandTotal)*100).toFixed(1);
    const progW = Math.min((r.val/grandTotal)*100*3, 100);
    bd.innerHTML += `<div class="flex justify-between items-center px-5 py-3.5 hover:bg-zinc-50 dark:hover:bg-zinc-800/30 transition-colors">
      <div class="flex items-start gap-3 flex-1 min-w-0">
        <div class="w-2 h-2 rounded-sm mt-1.5 flex-shrink-0" style="background:${r.color}"></div>
        <div class="min-w-0">
          <div class="text-sm font-medium text-zinc-700 dark:text-zinc-300">${r.name}</div>
          <div class="text-[10px] font-mono text-zinc-400 dark:text-zinc-600 mt-0.5">${r.note}</div>
          <div class="mt-2 h-1 bg-zinc-100 dark:bg-zinc-800 rounded-full w-32 overflow-hidden">
            <div class="h-full rounded-full prog-bar-fill" style="width:${progW}%;background:${r.color}"></div>
          </div>
        </div>
      </div>
      <div class="text-right flex-shrink-0 ml-4">
        <div class="font-mono text-sm font-semibold" style="color:${r.color}">${fmt(r.val)}</div>
        <div class="text-[9px] font-mono text-zinc-400 mt-0.5">${pct}%</div>
      </div>
    </div>`;
  });

  // Duty note + alerts
  let notes = `<div class="mx-0 px-5 py-3 bg-amber-50 dark:bg-amber-950/30 border border-amber-100 dark:border-amber-900 rounded-xl text-[11.5px] text-amber-800 dark:text-amber-300 leading-relaxed">
    â„¹ï¸ <strong>${pname}</strong> â€” Import duty ${Math.round(dutyR*100)}% Â· Live rate â‚¦${Math.round(liveRate).toLocaleString()}/${curr} Â· Total cost markup: <strong>${markup.toFixed(1)}%</strong> Â· Min. selling price at 20% margin: <strong>${fmt(minSell/qty)}</strong>/unit. Always confirm HS Code with a licensed NCS broker before shipment.
  </div>`;
  if (markup > 80) notes += `<div class="px-5 py-3 bg-red-50 dark:bg-red-950/30 border border-red-100 dark:border-red-900 rounded-xl text-[11.5px] text-red-700 dark:text-red-400">âš ï¸ <strong>High Markup Alert:</strong> Your landed cost is ${markup.toFixed(1)}% above FOB price. Consider local sourcing or Dubai re-export to reduce duties and freight costs.</div>`;
  if (dutyR === 0) notes += `<div class="px-5 py-3 bg-emerald-50 dark:bg-emerald-950/30 border border-emerald-100 dark:border-emerald-900 rounded-xl text-[11.5px] text-emerald-700 dark:text-emerald-400">âœ… <strong>Duty Exempt:</strong> This category is exempt from import duty. Ensure documentation correctly reflects the HS Code to maintain exemption at port.</div>`;
  if (vatR  === 0) notes += `<div class="px-5 py-3 bg-emerald-50 dark:bg-emerald-950/30 border border-emerald-100 dark:border-emerald-900 rounded-xl text-[11.5px] text-emerald-700 dark:text-emerald-400">âœ… <strong>VAT Exempt:</strong> Food, medicines, and agro inputs are VAT-exempt under FIRS Schedule. Confirm with your customs broker at filing.</div>`;
  document.getElementById('duty-note-area').innerHTML = notes;

  // â”€â”€ PIE CHART â”€â”€
  const dark       = isDark();
  const tickColor  = dark ? '#52525b' : '#a1a1aa';
  const gridColor  = dark ? 'rgba(255,255,255,.04)' : 'rgba(0,0,0,.04)';
  const borderC    = dark ? '#18181b' : '#ffffff';
  const tooltipBg  = dark ? '#18181b' : '#ffffff';
  const tooltipBdr = dark ? '#3f3f46' : '#e4e4e7';
  const tooltipTtl = dark ? '#f4f4f5' : '#18181b';

  const pieData   = [fobTotal, freightT+insurance, allDuties, vat, portTotal];
  const pieLabels = ['Product Cost','Freight & Ins.','Duties & Levies','VAT','Port & Clearing'];
  const pieColors = ['#1d4ed8','#3b82f6','#f59e0b','#10b981','#6b7280'];

  if (pieInst) pieInst.destroy();
  pieInst = new Chart(document.getElementById('pieChart'), {
    type:'doughnut',
    data:{labels:pieLabels,datasets:[{data:pieData,backgroundColor:pieColors,borderColor:borderC,borderWidth:3,hoverOffset:6}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'62%',
      plugins:{legend:{position:'bottom',labels:{color:tickColor,boxWidth:9,font:{size:9,family:'JetBrains Mono'},padding:10}},
        tooltip:{backgroundColor:tooltipBg,borderColor:tooltipBdr,borderWidth:1,titleColor:tooltipTtl,bodyColor:tickColor,
          callbacks:{label:c=>' '+c.label+': '+fmt(c.raw)+' ('+((c.raw/grandTotal)*100).toFixed(1)+'%)'}}}}
  });

  // â”€â”€ FX SENSITIVITY â”€â”€
  const baseR = NGN_USD;
  const scRates = [
    Math.round(baseR*.65), Math.round(baseR*.8), Math.round(baseR*.9),
    Math.round(baseR), Math.round(baseR*1.15), Math.round(baseR*1.3),
    Math.round(baseR*1.5), Math.round(baseR*1.75),
  ];
  const scCosts = scRates.map(rate => {
    const f2  = unitUSD * rate * qty;
    const c2  = f2 + freightT + f2*0.005;
    const d2  = c2*(dutyR+levyR+0.01+0.005) + c2*dutyR*0.07;
    const v2  = (c2+d2)*vatR;
    const p2  = c2*0.02 + clearing;
    return Math.round((c2+d2+v2+p2)/1e6*10)/10;
  });

  if (fxInst) fxInst.destroy();
  const fxCtx = document.getElementById('fxChart').getContext('2d');
  const grad  = fxCtx.createLinearGradient(0,0,0,180);
  grad.addColorStop(0,'rgba(16,185,129,.14)');
  grad.addColorStop(1,'rgba(16,185,129,0)');

  fxInst = new Chart(fxCtx, {
    type:'line',
    data:{
      labels:scRates.map(r=>'â‚¦'+r.toLocaleString()),
      datasets:[{
        data:scCosts, borderColor:'#10b981', backgroundColor:grad,
        fill:true, tension:.4, borderWidth:2.5,
        pointRadius:scRates.map(r=>r===Math.round(baseR)?8:3),
        pointBackgroundColor:scRates.map(r=>r===Math.round(baseR)?'#f59e0b':'#10b981'),
        pointBorderColor:borderC, pointBorderWidth:2,
      }]
    },
    options:{responsive:true,maintainAspectRatio:false,
      plugins:{legend:{display:false},
        tooltip:{backgroundColor:tooltipBg,borderColor:tooltipBdr,borderWidth:1,titleColor:tooltipTtl,bodyColor:tickColor,
          callbacks:{
            title:c=>'If USD/NGN = '+c[0].label,
            label:c=>' Total: â‚¦'+c.raw+'M landed',
            afterLabel:c=>scRates[c.dataIndex]===Math.round(baseR)?' â† Live rate today':''
          }}},
      scales:{
        x:{grid:{display:false},ticks:{color:tickColor,font:{size:9,family:'JetBrains Mono'}},
           title:{display:true,text:'USD/NGN Rate Scenarios',color:tickColor,font:{size:9}}},
        y:{grid:{color:gridColor},ticks:{color:tickColor,font:{size:9,family:'JetBrains Mono'},callback:v=>'â‚¦'+v+'M'},
           title:{display:true,text:'Total Cost (â‚¦M)',color:tickColor,font:{size:9}}}
      }
    }
  });

  document.getElementById('res-total-card').scrollIntoView({behavior:'smooth',block:'nearest'});
}

function setFlash(id, text) {
  const el = document.getElementById(id);
  el.textContent = text;
  el.classList.remove('flash');
  void el.offsetWidth;
  el.classList.add('flash');
}

// â”€â”€ OS DARK MODE â†’ re-render charts â”€â”€
window.matchMedia('(prefers-color-scheme:dark)').addEventListener('change', () => {
  if (document.getElementById('pieChart').getContext('2d')) calculate();
});

// â”€â”€ INIT â”€â”€
onCategoryChange();
onCountryChange();
onPortChange();
loadRates();
</script>
</body>
</html>
